{% extends "layouts/base.html" %} {% block title %} Dashboard {% endblock %}

<!-- Specific Page CSS goes HERE  -->
{% block stylesheets %}

<style>
  input[type="file"] {
    display: block;
  }
  .imageThumb {
    max-height: 75px;
    border: 2px solid;
    padding: 1px;
    cursor: pointer;
  }
  .pip {
    display: inline-block;
    margin: 10px 10px 0 0;
  }
  .remove {
    display: block;
    background: #444;
    border: 1px solid black;
    color: white;
    text-align: center;
    cursor: pointer;
  }
  .remove:hover {
    background: white;
    color: black;
  }
</style>

{% endblock stylesheets %} {% block content %}
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<div class="field" align="left">
  <h3>Upload your Files</h3>
  <form action="?" enctype="multipart/form-data" method="post">
    {% csrf_token %}
    <input type="file" id="files" name="files" multiple />
    <br />
    <input type="submit" value="Upload" />
  </form>
</div>

{% endblock content %}

<!-- Specific Page JS goes HERE  -->
{% block javascripts %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script>
  $(document).ready(function () {
    if (window.File && window.FileList && window.FileReader) {
      $("#files").on("change", function (e) {
        var files = e.target.files,
          filesLength = files.length;
        for (var i = 0; i < filesLength; i++) {
          var f = files[i];
          var fileReader = new FileReader();
          fileReader.onload = function (e) {
            var file = e.target;
            console.log(f);
            $(
              '<span class="pip"><img class="imageThumb" src="https://cdn-icons-png.flaticon.com/512/732/732220.png" title="' +
                f.name +
                '"/>' +
                '<br/><span class="remove">Remove image</span>' +
                "</span>"
            ).insertAfter("#files");
            $(".remove").click(function () {
              $(this).parent(".pip").remove();
            });

            // Old code here
            /*$("<img></img>", {
                  class: "imageThumb",
                  src: e.target.result,
                  title: file.name + " | Click to remove"
                }).insertAfter("#files").click(function(){$(this).remove();});*/
          };
          fileReader.readAsDataURL(f);
        }
        console.log(files);
      });
    } else {
      alert("Your browser doesn't support to File API");
    }
  });
</script>

{% endblock javascripts %}
